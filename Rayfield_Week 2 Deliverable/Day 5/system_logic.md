# Team System Logic Sketch
This document explains how our data pipeline behaves with AI/ML integrated. It includes the trigger, processing steps, model behavior, and how results are delivered to end users.

## System Overview
The pipeline takes in energy data (in CSV form), processes it, runs an anomaly detection model (Isolation Forest), and delivers the output to users through email and reports.

## System Flow (Step-by-Step)
1. **Data Upload**
   - A user uploads a new CSV file through the web interface.
   - Alternatively, a daily CRON job pulls data from an API (future plan).
2. **Data Ingestion**
   - The uploaded file is loaded using `pandas`.
   - The system checks column names and formats.
3. **Data Cleaning**
   - Missing values are filled or flagged.
   - Dates are converted to proper `datetime` format.
   - Column names are standardized.
4. **Feature Engineering**
   - The following features are generated:
     - 7-day rolling average
     - Percent change from previous day
     - Time since last peak
5. **Run ML Model**
   - The cleaned dataset is passed to the Isolation Forest model.
   - The model returns:
     - A binary flag (`1` for anomaly, `0` for normal)
     - Anomaly score for each record
6. **Post-Processing**
   - Anomaly results are merged back into the main dataset.
   - Summary statistics (e.g., number of anomalies) are calculated.
7. **Output Generation**
   - The following files are created:
     - `anomaly_report.csv`
     - `summary.txt` (optional: generated by GPT)
   - Charts (time series with anomalies highlighted) are also created.
8. **Result Sharing**
   - Reports and summaries are sent to team members via email.
   - Optional: results are posted to Slack or exported as a PDF report.
9. **User Review**
   - The Performance Analyst reviews anomalies flagged by the system.
   - If needed, they schedule a deeper inspection or add manual comments.

## Human Involvement
- Manual upload (or automatic scheduling in future)
- Human review of flagged anomalies and summary
- Analyst uses output for reporting and maintenance planning

## Trigger Options
| Trigger Type   | Status   | Notes                                 |
|----------------|----------|----------------------------------------|
| Manual Upload  | Active   | Done via simple upload form or notebook |
| Daily CRON Job | Planned  | To automate ingestion from API         |
| Button Trigger | Optional | Could be used for "Run Model" in UI    |